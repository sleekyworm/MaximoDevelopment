<?xml version="1.0" encoding="UTF-8"?>
<report xmlns="http://www.eclipse.org/birt/2005/design" version="3.2.23" id="1">
    <property name="comments">Copyright (c) 2006 &lt;&lt;Your Company Name here>></property>
    <property name="createdBy">Eclipse BIRT Designer Version 4.3.1.v201309091055 Build &lt;4.3.1.v20130917-1035></property>
    <html-property name="description">This template will create a report with one or more subreports, each having different data fields.</html-property>
    <simple-property-list name="includeResource">
        <value>wotrack</value>
    </simple-property-list>
    <property name="units">in</property>
    <method name="initialize"><![CDATA[importPackage(Packages.com.ibm.tivoli.maximo.report.script);

mxReportScriptContext = MXReportScriptContext.initialize(reportContext);

mxReportScriptContext.setDefaultLogLevel("DEBUG");
mxReportScriptContext.setDefaultLogFile("C:/temp/open_wo_pm.log");

scriptLogger = mxReportScriptContext.getReportScriptLogger();

isAsset = (BirtComp.notEqual(params["asset"],null) &amp;&amp; BirtComp.notEqual(params["asset"],""));
isLocation = (BirtComp.notEqual(params["location"],null) &amp;&amp; BirtComp.notEqual(params["location"],""));

if (scriptLogger.isDebugEnabled()) {
	scriptLogger.debug("[initialize()] >>> isAsset: " + isAsset);
	scriptLogger.debug("[initialize()] >>> isLocation: " + isLocation);
}

//Sets empty string for non-required parameters that cause problems for being null
if(BirtComp.equalTo(params["asset"], null)) {
	params["asset"] = "";
}
//Sets empty string for non-required parameters that cause problems for being null
if(BirtComp.equalTo(params["location"], null)) {
	params["location"] = "";
}
//Sets empty string for non-required parameters that cause problems for being null
if(BirtComp.equalTo(params["site"], null)) {
	params["site"] = "";
}

function rollDate(baseDate, numDays) {
	var gc = new java.util.GregorianCalendar();
	gc.setTime(baseDate);
	
	for(var n=0;n<numDays;n++) {
		if(endOfYear(gc)) {
			gc.roll(java.util.Calendar.YEAR, 1);
			gc.set(java.util.Calendar.MONTH, 1);
			gc.set(java.util.Calendar.DAY_OF_YEAR, 1);
		} else {
			gc.roll(java.util.Calendar.DAY_OF_YEAR, 1);
		}
	}
	return(gc.getTime());
}

function endOfYear(testCal) {
	return (testCal.get(java.util.Calendar.DAY_OF_MONTH) == 31 &amp;&amp; testCal.get(java.util.Calendar.MONTH) == 11);
}

function rollToOpenDay(daysSet, baseDate) {
	var openDays = new Array();
	
	openDays[0] = daysSet.getInteger("sunday");
	openDays[1] = daysSet.getInteger("monday");
	openDays[2] = daysSet.getInteger("tuesday");
	openDays[3] = daysSet.getInteger("wednesday");
	openDays[4] = daysSet.getInteger("thursday");
	openDays[5] = daysSet.getInteger("friday");
	openDays[6] = daysSet.getInteger("saturday");
	
	var isThereAnOpenDay = false;
	for(var i=0; i<openDays.length; i++) 
		if(isThereAnOpenDay == false &amp;&amp; openDays[i] != 0) isThereAnOpenDay = true;
	
	var gc = new java.util.GregorianCalendar();
	gc.setTime(baseDate);
	var dayIdx = gc.get(java.util.Calendar.DAY_OF_WEEK);
	// if there are no open days or today's day is open, return today
	if(isThereAnOpenDay == false || openDays[dayIdx] != 0) return baseDate;
	
	var dayCnt = 1;
	// we know there's one in there, so keep going till we find one
	while(true) {
		if(openDays[++dayIdx] != 0) {
			return rollDate(baseDate, dayCnt);
		} else {
			dayCnt++;
			if(dayIdx > 6) dayIdx = 0;
		}
	}
}]]></method>
    <method name="afterFactory"><![CDATA[MXReportScriptContext.close();]]></method>
    <property name="theme">MaximoSystemLibrary.maximoTheme</property>
    <text-property name="displayName">Tivoli Maximo Subreport Template</text-property>
    <property name="layoutPreference">auto layout</property>
    <list-property name="libraries">
        <structure>
            <property name="fileName">MaximoSystemLibrary.rptlibrary</property>
            <property name="namespace">MaximoSystemLibrary</property>
        </structure>
    </list-property>
    <parameters>
        <scalar-parameter name="where" id="25">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <simple-property-list name="defaultValue">
                <value type="constant">1=1</value>
            </simple-property-list>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="appname" id="731">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant">PM</value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="paramdelimiter" id="733">
            <property name="hidden">true</property>
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="paramstring" id="732">
            <property name="hidden">true</property>
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="asset" id="829">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant">=11430</value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="location" id="830">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="site" id="831">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant">=BEDFORD</value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
    </parameters>
    <data-sources>
        <script-data-source name="maximoDataSource" id="64" extends="MaximoSystemLibrary.maximoDataSource"/>
    </data-sources>
    <data-sets>
        <script-data-set name="mainDataSet" id="5">
            <list-property name="resultSetHints">
                <structure>
                    <property name="position">1</property>
                    <property name="name">siteid</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">2</property>
                    <property name="name">location</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">3</property>
                    <property name="name">assetnum</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">4</property>
                    <property name="name">descr</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">5</property>
                    <property name="name">key</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">6</property>
                    <property name="name">isasset</property>
                    <property name="dataType">integer</property>
                </structure>
            </list-property>
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">siteid</property>
                </structure>
                <structure>
                    <property name="columnName">location</property>
                </structure>
                <structure>
                    <property name="columnName">assetnum</property>
                </structure>
                <structure>
                    <property name="columnName">descr</property>
                </structure>
                <structure>
                    <property name="columnName">uidcount</property>
                </structure>
                <structure>
                    <property name="columnName">isworkorder</property>
                </structure>
                <structure>
                    <property name="columnName">key</property>
                </structure>
                <structure>
                    <property name="columnName">isasset</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">siteid</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">location</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">3</property>
                        <property name="name">assetnum</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">4</property>
                        <property name="name">descr</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">5</property>
                        <property name="name">key</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">6</property>
                        <property name="name">isasset</property>
                        <property name="dataType">integer</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">maximoDataSource</property>
            <method name="open"><![CDATA[mainDataSet = MXReportDataSetProvider.create(this.getDataSource().getName(), this.getName());
mainDataSet.open();

var sqlText = new String();
var sqlTextWO = new String();
var sqlTextPM = new String();
		
mustStop = false;

//debug helper var
shown = false;

//if both asset and location are provided or none is provided an error must be shown to the user
if( (isAsset &amp;&amp; isLocation) || (!isAsset &amp;&amp; !isLocation) ){
	mustStop=true;
}
if (scriptLogger.isDebugEnabled()) {
	scriptLogger.debug("["+mainDataSet.getName() + "] >>> mustStop: " + mustStop);
}

// *
// * Finding the main table name for the calling app
// * although it will only accept workorder or pm
// * and defaults to workorder
// *
//tableName = "workorder";  
//appTableDS = MXReportDataSetProvider.create(this.getDataSource().getName(), "appTableDS");
//appTableDS.open();

//var appTableSQL = "select lower(maintbname) as maintbname from maxapps where app=?";

//appTableDS.setQuery(appTableSQL);
//appTableDS.setQueryParameterValue(1, params["appname"]);

//if(appTableDS.fetch()) {
//	tableName = appTableDS.getString("maintbname");
//}
//main table found


// if maintable is workorder
//if(!mustStop &amp;&amp; "workorder" == tableName) {
if(!mustStop) {
	var localWhere = "1=1";
	if (BirtComp.equalTo(params["appname"].value,"WOTRACK")) {
		localWhere = params["where"];
	}	

	localWhere += " and " +  MXReportSqlFormat.createParamWhereClause("workorder.siteid", params["site"].toUpperCase());
	
	if(isAsset) {
		localWhere += " and " +  MXReportSqlFormat.createParamWhereClause("workorder.assetnum", params["asset"].toUpperCase());
		
		sqlTextWO = "select distinct workorder.siteid, workorder.assetnum, "
		+ " 1 as isasset, "
		+ " (select asset.description from asset "
		+ " where asset.siteid=workorder.siteid and asset.assetnum=workorder.assetnum) as descr "
		;
	} 
	else if(isLocation) {
		localWhere += " and " +  MXReportSqlFormat.createParamWhereClause("workorder.location", params["location"].toUpperCase());
		
		sqlTextWO = "select distinct workorder.siteid, workorder.location, "
		+ " 0 as isasset, "
		+ " (select locations.description from locations "
		+ " where locations.siteid=workorder.siteid and locations.location=workorder.location) as descr "
		;
	}
	
	//just debug
	//if (scriptLogger.isDebugEnabled()) {
		//sqlText += " count(workorder.workorderid) over() as uidcount, "
		//+ " count(workorder.workorderid) over(partition by workorder.siteid) as siteidcount, "
		//+ " count(workorder.location) over(partition by workorder.location) as locationcount, "
		//+ " count(workorder.assetnum) over(partition by workorder.assetnum) as assetnumcount, "
		//;
	//}
	
	sqlTextWO += " from workorder inner join "
	+ " pm on "
	+ "  workorder.siteid = pm.siteid "
	+ "  and workorder.pmnum = pm.pmnum "
	+ " where " + localWhere
	;
	
	//if(isAsset) {
	//	sqlTextWO += " order by workorder.siteid, workorder.assetnum"
	//	;
	//} 
	//else if(isLocation) {
	//	sqlTextWO += " order by workorder.siteid, workorder.location"
	//	;
	//}
}
//if maintable is pm
//else if(!mustStop &amp;&amp; "pm" == tableName) {
if(!mustStop) {
	var localWhere = "1=1";
	if (BirtComp.equalTo(params["appname"].value,"WOTRACK")) {
		localWhere = params["where"];
	}	
	localWhere += " and " +  MXReportSqlFormat.createParamWhereClause("pm.siteid", params["site"].toUpperCase());

	if(isAsset) {
		localWhere += " and " +  MXReportSqlFormat.createParamWhereClause("pm.assetnum", params["asset"].toUpperCase());
		
		sqlTextPM = "select distinct pm.siteid, pm.assetnum, "
		+ " 1 as isasset, "
		+ " (select asset.description from asset "
		+ " where asset.siteid=pm.siteid and asset.assetnum=pm.assetnum) as descr "
		;
	}
	else if(isLocation) {
		localWhere += " and " +  MXReportSqlFormat.createParamWhereClause("pm.location", params["location"].toUpperCase());
		
		sqlTextPM = "select distinct pm.siteid, pm.location, "
		+ " 0 as isasset, "
		+ " (select locations.description from locations "
		+ " where locations.siteid=pm.siteid and locations.location=pm.location) as descr "
		;
	}
	
	//just debug
	//if (scriptLogger.isDebugEnabled()) {
		//sqlText += " count(pm.pmuid) over() as uidcount, "
		//+ " count(pm.pmuid) over(partition by pm.siteid) as siteidcount, "
		//+ " count(pm.location) over(partition by pm.location) as locationcount, "
		//+ " count(pm.assetnum) over(partition by pm.assetnum) as assetnumcount, "
		//;
	//}
	
	sqlTextPM += " from pm inner join "
	+ " workorder on "
	+ "  pm.siteid = workorder.siteid "
	+ "  and pm.pmnum = workorder.pmnum "
	+ " where " + localWhere
	;
	
	//if(isAsset) {
		//sqlTextPM += " order by pm.siteid, pm.assetnum"
		//;
	//}
	//else if(isLocation) {
		//sqlTextPM += " order by pm.siteid, pm.location"
	//	;
	//}
	sqlText = sqlTextPM + " union " + sqlTextWO + " order by 1, 2"
} else {
	sqlText = "select distinct workorder.siteid, workorder.location, "
		+ " 0 as isasset from workorder "
		+ " where workorder.siteid <> workorder.siteid and workorder.wonum <> workorder.wonum "
		;
}



mainDataSet.setQuery(sqlText);]]></method>
            <method name="fetch"><![CDATA[//if(mustStop)
//	return false;
if(!mainDataSet.fetch()) 
	return false;
	
row["siteid"] = mainDataSet.getString("siteid");
row["isasset"] = mainDataSet.getInteger("isasset");
if(mainDataSet.getInteger("isasset")) {
	row["key"] = mainDataSet.getString("assetnum");
	row["assetnum"] = mainDataSet.getString("assetnum");
}
else {
	row["key"] = mainDataSet.getString("location");
	row["location"] = mainDataSet.getString("location");
}
row["descr"] = mainDataSet.getString("descr");

// counts for debug
//if (scriptLogger.isDebugEnabled() &amp;&amp; !shown) {
	//shown = true;
	//scriptLogger.debug("["+mainDataSet.getName() + "] >>> siteidcount: " + mainDataSet.getInteger("siteidcount"));
	//scriptLogger.debug("["+mainDataSet.getName() + "] >>> locationcount: " + mainDataSet.getInteger("locationcount"));
	//scriptLogger.debug("["+mainDataSet.getName() + "] >>> assetnumcount: " + mainDataSet.getInteger("assetnumcount"));
//}

return (true);
]]></method>
        </script-data-set>
        <script-data-set name="woDataSet" id="239">
            <list-property name="resultSetHints">
                <structure>
                    <property name="position">1</property>
                    <property name="name">workorderid</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">2</property>
                    <property name="name">wonum</property>
                </structure>
                <structure>
                    <property name="position">3</property>
                    <property name="name">description</property>
                </structure>
                <structure>
                    <property name="position">4</property>
                    <property name="name">status</property>
                </structure>
                <structure>
                    <property name="position">5</property>
                    <property name="name">key</property>
                </structure>
                <structure>
                    <property name="position">6</property>
                    <property name="name">keydesc</property>
                </structure>
                <structure>
                    <property name="position">7</property>
                    <property name="name">remdur</property>
                    <property name="dataType">decimal</property>
                </structure>
                <structure>
                    <property name="position">8</property>
                    <property name="name">schedstart</property>
                    <property name="dataType">date-time</property>
                </structure>
                <structure>
                    <property name="position">9</property>
                    <property name="name">schedfinish</property>
                    <property name="dataType">date-time</property>
                </structure>
                <structure>
                    <property name="position">10</property>
                    <property name="name">actstart</property>
                    <property name="dataType">date-time</property>
                </structure>
                <structure>
                    <property name="position">11</property>
                    <property name="name">isasset</property>
                    <property name="dataType">integer</property>
                </structure>
            </list-property>
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">wonum</property>
                </structure>
                <structure>
                    <property name="columnName">description</property>
                </structure>
                <structure>
                    <property name="columnName">status</property>
                </structure>
                <structure>
                    <property name="columnName">key</property>
                </structure>
                <structure>
                    <property name="columnName">keydesc</property>
                </structure>
                <structure>
                    <property name="columnName">remdur</property>
                </structure>
                <structure>
                    <property name="columnName">schedstart</property>
                </structure>
                <structure>
                    <property name="columnName">schedfinish</property>
                </structure>
                <structure>
                    <property name="columnName">actstart</property>
                </structure>
                <structure>
                    <property name="columnName">isasset</property>
                </structure>
                <structure>
                    <property name="columnName">workorderid</property>
                </structure>
            </list-property>
            <list-property name="parameters">
                <structure>
                    <property name="name">isasset</property>
                    <property name="dataType">integer</property>
                    <property name="position">1</property>
                    <expression name="defaultValue">1</expression>
                    <property name="isInput">true</property>
                    <property name="isOutput">true</property>
                </structure>
                <structure>
                    <property name="name">siteid</property>
                    <property name="dataType">string</property>
                    <property name="position">2</property>
                    <expression name="defaultValue">""</expression>
                    <property name="isInput">true</property>
                    <property name="isOutput">true</property>
                </structure>
                <structure>
                    <property name="name">location</property>
                    <property name="dataType">string</property>
                    <property name="position">3</property>
                    <expression name="defaultValue">""</expression>
                    <property name="isInput">true</property>
                    <property name="isOutput">true</property>
                </structure>
                <structure>
                    <property name="name">assetnum</property>
                    <property name="dataType">string</property>
                    <property name="position">4</property>
                    <expression name="defaultValue">""</expression>
                    <property name="isInput">true</property>
                    <property name="isOutput">true</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">workorderid</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">wonum</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">3</property>
                        <property name="name">description</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">4</property>
                        <property name="name">status</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">5</property>
                        <property name="name">key</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">6</property>
                        <property name="name">keydesc</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">7</property>
                        <property name="name">remdur</property>
                        <property name="dataType">decimal</property>
                    </structure>
                    <structure>
                        <property name="position">8</property>
                        <property name="name">schedstart</property>
                        <property name="dataType">date-time</property>
                    </structure>
                    <structure>
                        <property name="position">9</property>
                        <property name="name">schedfinish</property>
                        <property name="dataType">date-time</property>
                    </structure>
                    <structure>
                        <property name="position">10</property>
                        <property name="name">actstart</property>
                        <property name="dataType">date-time</property>
                    </structure>
                    <structure>
                        <property name="position">11</property>
                        <property name="name">isasset</property>
                        <property name="dataType">integer</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">maximoDataSource</property>
            <method name="open"><![CDATA[woDataSet = MXReportDataSetProvider.create(this.getDataSource().getName(), this.getName());

woDataSet.open();

var sqlText = new String();

var currentDate = new Date();
if(inputParams["isasset"]) {
	sqlText = "select distinct workorder.workorderid, workorder.wonum, workorder.description, workorder.status, "
	+ " workorder.location, workorder.assetnum, workorder.istask, workorder.parent, " 
	+ " locations.description as keydesc, workorder.remdur, workorder.schedstart, workorder.schedfinish, workorder.actstart " 
	+ "  from workorder left outer join locations on "
	+ "  workorder.siteid = locations.siteid "
	+ "  and workorder.location = locations.location " 
	+ " where workorder.siteid = '" + inputParams["siteid"] + "' "
	+ " and workorder.status not in ("
	+ "  select value from synonymdomain where domainid = 'wostatus' and maxvalue in ('CLOSE', 'COMP', 'CAN') "
	+ " ) " 
	+ " and workorder.assetnum = '" + inputParams["assetnum"] + "' " 
	+ " and workorder.actfinish is null "
	+ " and ( "
	+ "  (workorder.istask = 0 and workorder.assetnum = '" + inputParams["assetnum"].toUpperCase() + "' ) "
	+ "  or ( "
	+ "   workorder.istask = 1 and workorder.assetnum <> '" + inputParams["assetnum"].toUpperCase() + "' " 
	+ "   and exists ( "
	+ "    select 1 from workorder w " 
	+ "    where workorder.parent = w.wonum " 
	+ "    and w.siteid = '" + inputParams["siteid"].toUpperCase() + "' "
	+ "    and w.assetnum = '" + inputParams["assetnum"].toUpperCase() + "' ) "
	+ "   ) "
	+ "  ) " 
	+ "  and ( "
	+ "  (workorder.istask = 0 and workorder.assetnum = '" + inputParams["assetnum"].toUpperCase() + "' ) "
	+ "  or ( "
	+ "   exists ("
	+ "    select 1 from workorder w "
	+ "    where w.parent = workorder.wonum " 
	+ "    and w.orgid = workorder.orgid and w.siteid = workorder.siteid "
	+ "    and w.assetnum <> '" + inputParams["assetnum"].toUpperCase() + "' and w.istask = 1 "
	+ "   ) "
	+ "  ) "
	+ " ) "
	+ " order by workorder.schedstart"
	;
}
else {
	sqlText = "select workorder.workorderid, workorder.wonum, workorder.description, workorder.status, workorder.assetnum, "
	+ " asset.description as keydesc, workorder.remdur, "
	+ " workorder.schedstart, workorder.schedfinish, workorder.actstart, workorder.istask, workorder.parent, "
	+ " workorder.location "
	+ "  from workorder left outer join asset on "
	+ "  workorder.siteid = asset.siteid " 
	+ "  and workorder.assetnum = asset.assetnum " 
	+ " where workorder.status not in ("
	+ "  select value from synonymdomain where domainid = 'WOSTATUS' and maxvalue in ('CLOSE', 'COMP', 'CAN') "
	+ " ) "
	+ " and workorder.actfinish is null "
	+ " and exists ("
	+ "  select locancestor.siteid from locancestor "
	+ "  where locancestor.ancestor = '" + inputParams["location"].toUpperCase() + "' "
	+ "  and location = workorder.location "
	+ "  and locancestor.systemid in ( "
	+ "   select locsystem.systemid from locsystem where locsystem.siteid = workorder.siteid "
	+ "  ) "
	+ "  and locancestor.siteid = '" + inputParams["siteid"].toUpperCase() + "' "
	+ " )"
	+ " and ((workorder.istask = 0 "
	+ " and exists ( "
	+ "  select locancestor.siteid from locancestor " 
	+ "  where locancestor.ancestor = workorder.location " 
	+ "  and workorder.location = '" + inputParams["location"].toUpperCase() + "' "
	+ "  and locancestor.systemid in ("
	+ "   select locsystem.systemid from locsystem where locsystem.siteid = workorder.siteid "
	+ "  ) "
	+ "  and locancestor.siteid = '" + inputParams["siteid"].toUpperCase() + "')) "
	+ " or (workorder.istask = 1 "
	+ " and exists ( "
	+ "  select locancestor.siteid " 
	+ "  from locancestor " 
	+ "  where locancestor.ancestor = workorder.location " 
	+ "  and workorder.location <> '" + inputParams["location"].toUpperCase() + "' " 
	+ "  and locancestor.systemid in (" 
	+ "   select locsystem.systemid from locsystem where locsystem.siteid = workorder.siteid" 
	+ "  ) " 
	+ "  and locancestor.siteid = '" + inputParams["siteid"].toUpperCase() + "' "
	+ " ) and exists (" 
	+ "  select 1 from workorder w where workorder.parent = w.wonum and w.siteid = '" + inputParams["siteid"].toUpperCase() + "' " 
	+ "  and w.location = '" + inputParams["location"].toUpperCase() + "' "
	+ "   ) " 
	+ "  ) " 
	+ " ) " 
	+ " order by workorder.schedstart"
	;
}

woDataSet.setQuery(sqlText);]]></method>
            <method name="fetch"><![CDATA[if (!woDataSet.fetch())
	return (false);

var key = new String();
var fetchAnother = true;

if(inputParams["isasset"]) {
	key = woDataSet.getString("location");
	row["isasset"]=inputParams["isasset"];	
} else {
	key = woDataSet.getString("assetnum");
	row["isasset"]=inputParams["isasset"];	
}

while(fetchAnother) {
	if(woDataSet.getInteger("istask") == 1 &amp;&amp; woDataSet.getString("parent") == key) {
		if (!woDataSet.fetch()) return (false);
	} else {
		fetchAnother = false;
	}	
}

row["workorderid"] = woDataSet.getString("workorderid");	
row["wonum"] = woDataSet.getString("wonum");
row["description"] = woDataSet.getString("description");	
row["status"] = woDataSet.getString("status");	
row["key"] = key;	
row["keydesc"] = woDataSet.getString("keydesc");	
row["remdur"] = woDataSet.getFloat("remdur");	
row["schedstart"] = woDataSet.getTimestamp("schedstart");	
row["schedfinish"] = woDataSet.getTimestamp("schedfinish");	
row["actstart"] = woDataSet.getTimestamp("actstart");	

return (true);]]></method>
        </script-data-set>
        <script-data-set name="pmDataSet" id="868">
            <list-property name="resultSetHints">
                <structure>
                    <property name="position">1</property>
                    <property name="name">pmnum</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">2</property>
                    <property name="name">description</property>
                </structure>
                <structure>
                    <property name="position">3</property>
                    <property name="name">nextdate</property>
                </structure>
            </list-property>
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">pmnum</property>
                </structure>
                <structure>
                    <property name="columnName">description</property>
                </structure>
                <structure>
                    <property name="columnName">nextdate</property>
                </structure>
            </list-property>
            <list-property name="parameters">
                <structure>
                    <property name="name">isasset</property>
                    <property name="dataType">integer</property>
                    <property name="position">1</property>
                    <expression name="defaultValue">1</expression>
                    <property name="isInput">true</property>
                    <property name="isOutput">true</property>
                </structure>
                <structure>
                    <property name="name">siteid</property>
                    <property name="dataType">string</property>
                    <property name="position">2</property>
                    <expression name="defaultValue">""</expression>
                    <property name="isInput">true</property>
                    <property name="isOutput">true</property>
                </structure>
                <structure>
                    <property name="name">location</property>
                    <property name="dataType">string</property>
                    <property name="position">3</property>
                    <expression name="defaultValue">""</expression>
                    <property name="isInput">true</property>
                    <property name="isOutput">true</property>
                </structure>
                <structure>
                    <property name="name">assetnum</property>
                    <property name="dataType">string</property>
                    <property name="position">4</property>
                    <expression name="defaultValue">""</expression>
                    <property name="isInput">true</property>
                    <property name="isOutput">true</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">pmnum</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">description</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">3</property>
                        <property name="name">nextdate</property>
                        <property name="dataType">string</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">maximoDataSource</property>
            <method name="open"><![CDATA[pmDataSet = MXReportDataSetProvider.create(this.getDataSource().getName(), this.getName());
pmDataSet.open();

var sqlText = new String();
var pmWhere = params["where"] + " and 2=2 ";

pmWhere += " and " + MXReportSqlFormat.createParamWhereClause("pm.siteid", "="+inputParams["siteid"].toUpperCase());

if (inputParams["isasset"] == 1) {
	pmWhere += " and " + MXReportSqlFormat.createParamWhereClause("pm.assetnum", "="+inputParams["assetnum"].toUpperCase());
} else {
	pmWhere += " and " + MXReportSqlFormat.createParamWhereClause("pm.location", "="+inputParams["location"].toUpperCase());
}

sqlText = "select distinct pm.pmnum, pm.description, min(pm.nextdate) as nextdate, "
+ " pm.sunday, pm.monday, pm.tuesday, pm.wednesday, pm.thursday, pm.friday, pm.saturday "
+ " from pm inner join "
+ " workorder on "
+ "  pm.siteid = workorder.siteid "
+ "  and pm.pmnum = workorder.pmnum "
+ " where " + pmWhere
+ " group by pm.pmnum, pm.description, pm.sunday, pm.monday, pm.tuesday, pm.wednesday, pm.thursday, pm.friday, pm.saturday  "
;

if (scriptLogger.isDebugEnabled()) {
	scriptLogger.debug("["+pmDataSet.getName() + "] >>> sqlText: " + sqlText);
}

pmDataSet.setQuery(sqlText);]]></method>
            <method name="fetch"><![CDATA[if (!pmDataSet.fetch())
	return (false);

row["pmnum"] = pmDataSet.getString("pmnum");	
row["description"] = pmDataSet.getString("description");	
row["nextdate"] = pmDataSet.getTimestamp("nextdate");	

return (true);]]></method>
        </script-data-set>
        <script-data-set name="pmMeterDataSet" id="884">
            <list-property name="resultSetHints">
                <structure>
                    <property name="position">1</property>
                    <property name="name">pmnum</property>
                </structure>
                <structure>
                    <property name="position">2</property>
                    <property name="name">metername</property>
                </structure>
                <structure>
                    <property name="position">3</property>
                    <property name="name">lastreading</property>
                    <property name="dataType">decimal</property>
                </structure>
                <structure>
                    <property name="position">4</property>
                    <property name="name">readingatnextwo</property>
                    <property name="dataType">decimal</property>
                </structure>
                <structure>
                    <property name="position">5</property>
                    <property name="name">average</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">6</property>
                    <property name="name">predicteddate</property>
                    <property name="dataType">date-time</property>
                </structure>
            </list-property>
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">pmnum</property>
                </structure>
                <structure>
                    <property name="columnName">metername</property>
                </structure>
                <structure>
                    <property name="columnName">lastreading</property>
                </structure>
                <structure>
                    <property name="columnName">readingatnextwo</property>
                </structure>
                <structure>
                    <property name="columnName">average</property>
                </structure>
                <structure>
                    <property name="columnName">predicteddate</property>
                </structure>
            </list-property>
            <list-property name="parameters">
                <structure>
                    <property name="name">isasset</property>
                    <property name="dataType">integer</property>
                    <property name="position">1</property>
                    <expression name="defaultValue">1</expression>
                    <property name="isInput">true</property>
                    <property name="isOutput">true</property>
                </structure>
                <structure>
                    <property name="name">siteid</property>
                    <property name="dataType">string</property>
                    <property name="position">2</property>
                    <expression name="defaultValue">""</expression>
                    <property name="isInput">true</property>
                    <property name="isOutput">true</property>
                </structure>
                <structure>
                    <property name="name">location</property>
                    <property name="dataType">string</property>
                    <property name="position">3</property>
                    <expression name="defaultValue">""</expression>
                    <property name="isInput">true</property>
                    <property name="isOutput">true</property>
                </structure>
                <structure>
                    <property name="name">assetnum</property>
                    <property name="dataType">string</property>
                    <property name="position">4</property>
                    <expression name="defaultValue">""</expression>
                    <property name="isInput">true</property>
                    <property name="isOutput">true</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">pmnum</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">metername</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">3</property>
                        <property name="name">lastreading</property>
                        <property name="dataType">decimal</property>
                    </structure>
                    <structure>
                        <property name="position">4</property>
                        <property name="name">readingatnextwo</property>
                        <property name="dataType">decimal</property>
                    </structure>
                    <structure>
                        <property name="position">5</property>
                        <property name="name">average</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">6</property>
                        <property name="name">predicteddate</property>
                        <property name="dataType">date-time</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">maximoDataSource</property>
            <method name="open"><![CDATA[pmMeterDataSet = MXReportDataSetProvider.create(this.getDataSource().getName(), this.getName());
pmMeterDataSet.open();

var sqlText = new String();
var pmMeterWhere = params["where"] + "and 2=2 ";

pmMeterWhere += " and " + MXReportSqlFormat.createParamWhereClause("pm.siteid", "="+inputParams["siteid"].toUpperCase());

if(inputParams["isasset"] == 1 ) {
	pmMeterWhere = MXReportSqlFormat.createParamWhereClause("pm.assetnum", "="+inputParams["assetnum"].toUpperCase());
} else {
	pmMeterWhere = MXReportSqlFormat.createParamWhereClause("pm.location", "="+inputParams["location"].toUpperCase());
}

sqlText = "select distinct pm.assetnum, pm.pmnum, pmmeter.metername, assetmeter.lastreading, assetmeter.lastreadingdate, "
+ " pmmeter.readingatnextwo, assetmeter.average, "
+ " pm.sunday, pm.monday, pm.tuesday, pm.wednesday, pm.thursday, pm.friday, pm.saturday, "
+ " pmseasons.startday as startday, "
+ " (select maxvalue from synonymdomain where synonymdomain.domainid = 'MONTH' and "
+ " synonymdomain.value = pmseasons.startmonth) as startmonth, "
+ " (select maxvalue from synonymdomain where synonymdomain.domainid = 'MONTH' and "
+ " synonymdomain.value = pmseasons.endmonth) as endmonth, "
+ " pmseasons.endday " 
+ " from assetmeter inner join "
+ " pmmeter on "
+ "  assetmeter.siteid = pmmeter.siteid " 
+ "  and assetmeter.assetnum = pmmeter.assetnum inner join " 
+ " pm on "
+ "  pmmeter.siteid = pm.siteid " 
+ "  and pmmeter.pmnum = pm.pmnum inner join "
+ " workorder on "
+ "  pm.siteid = workorder.siteid "
+ "  and pm.pmnum = workorder.pmnum left outer join "
+ " pmseasons on "
+ "  pm.siteid = pmseasons.siteid "
+ "  and pm.pmnum = pmseasons.pmnum " 
+ " where " + pmMeterWhere
;

pmMeterDataSet.setQuery(sqlText);]]></method>
            <method name="fetch"><![CDATA[if (!pmMeterDataSet.fetch())
	return (false);


row["pmnum"] = pmMeterDataSet.getString("pmnum");	
row["metername"] = pmMeterDataSet.getString("metername");

var l = reportContext.getLocale();
var nf = java.text.NumberFormat.getInstance(l);
var lastReading = nf.parse(pmMeterDataSet.getString("lastreading"));
row["lastreading"] = lastReading;
row["readingatnextwo"] = pmMeterDataSet.getFloat("readingatnextwo");	
row["average"] = pmMeterDataSet.getFloat("average");	

var predDate = new Date();

if(pmMeterDataSet.getInteger("startday") == null) {
	var predDays = (pmMeterDataSet.getFloat("readingatnextwo") - lastReading) / pmMeterDataSet.getFloat("average");
	if(predDays > 0) predDate = rollDate(predDate, predDays);
} else {
	var gcSt = new java.util.GregorianCalendar();
	var gcEd = new java.util.GregorianCalendar();
	var gcPred = new java.util.GregorianCalendar();
	gcPred.setTime(predDate);

	gcSt.set(java.util.Calendar.MONTH, pmMeterDataSet.getInteger("startmonth") - 1);
	gcSt.set(java.util.Calendar.DAY_OF_MONTH, pmMeterDataSet.getInteger("startday"));
	gcEd.set(java.util.Calendar.MONTH, pmMeterDataSet.getInteger("endmonth") - 1);
	gcEd.set(java.util.Calendar.DAY_OF_MONTH, pmMeterDataSet.getInteger("endday"));
	
	if(gcPred.after(gcSt) &amp;&amp; gcPred.before(gcEd)) gcPred = gcSt;
	gcPred.setTime(rollToOpenDay(pmMeterDataSet, gcPred.getTime()));
}

row["predicteddate"] = gcPred.getTime();	

return (true);]]></method>
        </script-data-set>
    </data-sets>
    <page-setup>
        <simple-master-page name="maximoLandscape" id="47" extends="MaximoSystemLibrary.maximoLandscape">
            <overridden-values>
                <ref-entry baseId="304" name="NewGrid2" id="304"/>
                <ref-entry baseId="305" id="305"/>
                <ref-entry baseId="306" id="306"/>
                <ref-entry baseId="307" id="307"/>
                <ref-entry baseId="308" id="308"/>
                <ref-entry baseId="309" id="309"/>
                <ref-entry baseId="310" name="NewImage" id="310"/>
                <ref-entry baseId="322" name="NewGrid" id="322"/>
                <ref-entry baseId="323" id="323"/>
                <ref-entry baseId="324" id="324"/>
                <ref-entry baseId="325" id="325"/>
                <ref-entry baseId="326" id="326"/>
                <ref-entry baseId="328" name="NewText" id="328"/>
                <ref-entry baseId="327" id="327"/>
                <ref-entry baseId="329" name="NewGrid1" id="329"/>
                <ref-entry baseId="330" id="330"/>
                <ref-entry baseId="331" id="331"/>
                <ref-entry baseId="332" id="332"/>
                <ref-entry baseId="333" id="333"/>
                <ref-entry baseId="334" id="334"/>
                <ref-entry baseId="335" name="NewAutoText" id="335"/>
                <ref-entry baseId="336" id="336"/>
                <ref-entry baseId="337" name="NewText1" id="337"/>
                <ref-entry baseId="338" id="338"/>
                <ref-entry baseId="339" name="NewAutoText1" id="339"/>
            </overridden-values>
        </simple-master-page>
    </page-setup>
    <body>
        <grid id="1343">
            <property name="width">100%</property>
            <column id="1344">
                <property name="width">10in</property>
            </column>
            <row id="1345">
                <list-property name="visibility">
                    <structure>
                        <property name="format">all</property>
                        <expression name="valueExpr">( (isAsset &amp;&amp; !isLocation) || (!isAsset &amp;&amp; isLocation) )</expression>
                    </structure>
                </list-property>
                <cell id="1346">
                    <grid id="1428">
                        <property name="width">100%</property>
                        <column id="1429">
                            <property name="width">10in</property>
                        </column>
                        <row id="1430">
                            <property name="style">title</property>
                            <cell id="1431">
                                <property name="borderBottomColor">#000000</property>
                                <property name="borderBottomStyle">solid</property>
                                <property name="borderBottomWidth">thin</property>
                                <label id="1033">
                                    <property name="marginBottom">3pt</property>
                                    <text-property name="text" key="openwo_title">Open Work Orders and PM Report</text-property>
                                </label>
                            </cell>
                        </row>
                        <row id="1432">
                            <property name="style">titlesub</property>
                            <cell id="1433">
                                <text-data id="1038">
                                    <property name="marginTop">3pt</property>
                                    <expression name="valueExpr">reportContext.getMessage("open_wo.warning", reportContext.getLocale())</expression>
                                    <property name="contentType">html</property>
                                </text-data>
                            </cell>
                        </row>
                    </grid>
                </cell>
            </row>
            <row id="1347">
                <list-property name="visibility">
                    <structure>
                        <property name="format">all</property>
                        <expression name="valueExpr">( (!isAsset &amp;&amp; !isLocation) || (isAsset &amp;&amp; isLocation) )</expression>
                    </structure>
                </list-property>
                <cell id="1348">
                    <table id="7">
                        <property name="width">100%</property>
                        <property name="dataSet">mainDataSet</property>
                        <list-property name="boundDataColumns">
                            <structure>
                                <property name="name">siteid</property>
                                <expression name="expression">dataSetRow["siteid"]</expression>
                                <property name="dataType">string</property>
                            </structure>
                            <structure>
                                <property name="name">location</property>
                                <expression name="expression">dataSetRow["location"]</expression>
                                <property name="dataType">string</property>
                            </structure>
                            <structure>
                                <property name="name">assetnum</property>
                                <expression name="expression">dataSetRow["assetnum"]</expression>
                                <property name="dataType">string</property>
                            </structure>
                            <structure>
                                <property name="name">isasset</property>
                                <expression name="expression">dataSetRow["isasset"]</expression>
                                <property name="dataType">integer</property>
                            </structure>
                            <structure>
                                <property name="name">descr</property>
                                <expression name="expression">dataSetRow["descr"]</expression>
                                <property name="dataType">string</property>
                            </structure>
                            <structure>
                                <property name="name">basecount</property>
                                <property name="dataType">integer</property>
                                <property name="aggregateFunction">COUNT</property>
                                <list-property name="arguments">
                                    <structure>
                                        <property name="name">Expression</property>
                                        <expression name="value">row["siteid"]</expression>
                                    </structure>
                                </list-property>
                            </structure>
                            <structure>
                                <property name="name">key</property>
                                <expression name="expression">dataSetRow["key"]</expression>
                                <property name="dataType">string</property>
                            </structure>
                        </list-property>
                        <property name="pageBreakInterval">50</property>
                        <column id="83">
                            <property name="width">2in</property>
                        </column>
                        <column id="79">
                            <property name="width">1in</property>
                        </column>
                        <column id="91">
                            <property name="width">2in</property>
                        </column>
                        <column id="87">
                            <property name="width">1in</property>
                        </column>
                        <column id="17">
                            <property name="width">2in</property>
                        </column>
                        <column id="18">
                            <property name="width">2in</property>
                        </column>
                        <header>
                            <row id="209">
                                <property name="style">title</property>
                                <property name="pageBreakInside">auto</property>
                                <cell id="210">
                                    <property name="colSpan">6</property>
                                    <property name="rowSpan">1</property>
                                    <label id="832">
                                        <text-property name="text" key="openwo_title">Open Work Orders and PM Report</text-property>
                                    </label>
                                </cell>
                            </row>
                        </header>
                        <group id="828">
                            <property name="groupName">tableGroup</property>
                            <property name="interval">none</property>
                            <property name="sortDirection">asc</property>
                            <expression name="keyExpr">row["key"]</expression>
                            <structure name="toc">
                                <expression name="expressionValue">row["key"]</expression>
                            </structure>
                            <property name="repeatHeader">true</property>
                            <property name="hideDetail">false</property>
                            <property name="pageBreakAfter">always-excluding-last</property>
                            <property name="pageBreakBefore">auto</property>
                            <property name="pageBreakInside">auto</property>
                        </group>
                        <detail>
                            <row id="615">
                                <property name="pageBreakInside">auto</property>
                                <cell id="616">
                                    <property name="colSpan">6</property>
                                    <property name="rowSpan">1</property>
                                    <property name="borderBottomColor">#000000</property>
                                    <property name="borderBottomStyle">solid</property>
                                    <property name="borderBottomWidth">thin</property>
                                    <property name="borderTopColor">#000000</property>
                                    <property name="borderTopStyle">solid</property>
                                    <property name="borderTopWidth">thin</property>
                                    <grid id="653">
                                        <property name="marginTop">2pt</property>
                                        <property name="marginBottom">2pt</property>
                                        <property name="width">100%</property>
                                        <column id="654">
                                            <property name="style">reportheaderlabel</property>
                                            <property name="width">1in</property>
                                        </column>
                                        <column id="655">
                                            <property name="style">reportheaderdata</property>
                                            <property name="width">9in</property>
                                        </column>
                                        <row id="659">
                                            <list-property name="visibility">
                                                <structure>
                                                    <property name="format">all</property>
                                                    <expression name="valueExpr">row["isasset"] == 0</expression>
                                                </structure>
                                            </list-property>
                                            <cell id="660">
                                                <label id="671">
                                                    <text-property name="text" key="assetcolon">Asset:</text-property>
                                                </label>
                                            </cell>
                                            <cell id="662">
                                                <property name="paddingLeft">2px</property>
                                                <data id="1613">
                                                    <property name="resultSetColumn">assetnum</property>
                                                </data>
                                            </cell>
                                        </row>
                                        <row id="979">
                                            <list-property name="visibility">
                                                <structure>
                                                    <property name="format">all</property>
                                                    <expression name="valueExpr">row["isasset"] == 1</expression>
                                                </structure>
                                            </list-property>
                                            <cell id="980">
                                                <label id="982">
                                                    <text-property name="text" key="openwo_location_colon">Location:</text-property>
                                                </label>
                                            </cell>
                                            <cell id="981">
                                                <property name="paddingLeft">2px</property>
                                                <data id="1614">
                                                    <property name="resultSetColumn">location</property>
                                                </data>
                                            </cell>
                                        </row>
                                        <row id="664">
                                            <cell id="665">
                                                <label id="673">
                                                    <text-property name="text" key="openwo_desc_colon">Description:</text-property>
                                                </label>
                                            </cell>
                                            <cell id="667">
                                                <property name="paddingLeft">2px</property>
                                                <data id="1615">
                                                    <property name="resultSetColumn">descr</property>
                                                </data>
                                            </cell>
                                        </row>
                                        <row id="833">
                                            <cell id="834">
                                                <label id="836">
                                                    <text-property name="text" key="openwo_site_colon">Site:</text-property>
                                                </label>
                                            </cell>
                                            <cell id="835">
                                                <property name="paddingLeft">2px</property>
                                                <data id="1616">
                                                    <property name="resultSetColumn">siteid</property>
                                                </data>
                                            </cell>
                                        </row>
                                    </grid>
                                </cell>
                            </row>
                            <row id="539">
                                <property name="pageBreakInside">auto</property>
                                <cell id="540">
                                    <property name="colSpan">6</property>
                                    <property name="rowSpan">1</property>
                                    <table id="546">
                                        <property name="marginTop">2pt</property>
                                        <property name="width">100%</property>
                                        <property name="dataSet">woDataSet</property>
                                        <list-property name="visibility">
                                            <structure>
                                                <property name="format">all</property>
                                                <expression name="valueExpr">row["wonumcount"]==0</expression>
                                            </structure>
                                        </list-property>
                                        <list-property name="paramBindings">
                                            <structure>
                                                <property name="paramName">isasset</property>
                                                <simple-property-list name="expression">
                                                    <value>row["isasset"]</value>
                                                </simple-property-list>
                                            </structure>
                                            <structure>
                                                <property name="paramName">siteid</property>
                                                <simple-property-list name="expression">
                                                    <value>row["siteid"]</value>
                                                </simple-property-list>
                                            </structure>
                                            <structure>
                                                <property name="paramName">location</property>
                                                <simple-property-list name="expression">
                                                    <value>row["location"]</value>
                                                </simple-property-list>
                                            </structure>
                                            <structure>
                                                <property name="paramName">assetnum</property>
                                                <simple-property-list name="expression">
                                                    <value>row["assetnum"]</value>
                                                </simple-property-list>
                                            </structure>
                                        </list-property>
                                        <list-property name="boundDataColumns">
                                            <structure>
                                                <property name="name">wonum</property>
                                                <expression name="expression">dataSetRow["wonum"]</expression>
                                                <property name="dataType">string</property>
                                            </structure>
                                            <structure>
                                                <property name="name">description</property>
                                                <expression name="expression">dataSetRow["description"]</expression>
                                                <property name="dataType">string</property>
                                            </structure>
                                            <structure>
                                                <property name="name">status</property>
                                                <expression name="expression">dataSetRow["status"]</expression>
                                                <property name="dataType">string</property>
                                            </structure>
                                            <structure>
                                                <property name="name">key</property>
                                                <expression name="expression">dataSetRow["key"]</expression>
                                                <property name="dataType">string</property>
                                            </structure>
                                            <structure>
                                                <property name="name">keydesc</property>
                                                <expression name="expression">dataSetRow["keydesc"]</expression>
                                                <property name="dataType">string</property>
                                            </structure>
                                            <structure>
                                                <property name="name">remdur</property>
                                                <expression name="expression">dataSetRow["remdur"]</expression>
                                                <property name="dataType">decimal</property>
                                            </structure>
                                            <structure>
                                                <property name="name">schedstart</property>
                                                <expression name="expression">dataSetRow["schedstart"]</expression>
                                                <property name="dataType">date-time</property>
                                            </structure>
                                            <structure>
                                                <property name="name">schedfinish</property>
                                                <expression name="expression">dataSetRow["schedfinish"]</expression>
                                                <property name="dataType">date-time</property>
                                            </structure>
                                            <structure>
                                                <property name="name">actstart</property>
                                                <expression name="expression">dataSetRow["actstart"]</expression>
                                                <property name="dataType">date-time</property>
                                            </structure>
                                            <structure>
                                                <property name="name">isasset</property>
                                                <expression name="expression">dataSetRow["isasset"]</expression>
                                                <property name="dataType">integer</property>
                                            </structure>
                                            <structure>
                                                <property name="name">wonumcount</property>
                                                <property name="dataType">integer</property>
                                                <property name="aggregateFunction">COUNT</property>
                                                <list-property name="arguments">
                                                    <structure>
                                                        <property name="name">Expression</property>
                                                        <expression name="value">row["wonum"]</expression>
                                                    </structure>
                                                </list-property>
                                            </structure>
                                            <structure>
                                                <property name="name">workorderid</property>
                                                <expression name="expression">dataSetRow["workorderid"]</expression>
                                                <property name="dataType">string</property>
                                            </structure>
                                        </list-property>
                                        <property name="pageBreakInterval">50</property>
                                        <column id="568">
                                            <property name="width">1in</property>
                                        </column>
                                        <column id="569">
                                            <property name="width">2in</property>
                                        </column>
                                        <column id="570">
                                            <property name="width">1in</property>
                                        </column>
                                        <column id="571">
                                            <property name="width">1in</property>
                                        </column>
                                        <column id="572">
                                            <property name="width">1in</property>
                                        </column>
                                        <column id="841">
                                            <property name="width">1in</property>
                                        </column>
                                        <column id="846">
                                            <property name="width">1in</property>
                                        </column>
                                        <column id="851">
                                            <property name="width">1in</property>
                                        </column>
                                        <column id="573">
                                            <property name="width">1in</property>
                                        </column>
                                        <header>
                                            <row id="675">
                                                <property name="style">tableheaderrow</property>
                                                <cell id="676">
                                                    <property name="colSpan">9</property>
                                                    <property name="rowSpan">1</property>
                                                    <property name="style">tableheaderlabel</property>
                                                    <label id="684">
                                                        <text-property name="text" key="openwo_openwo">Open Work Orders</text-property>
                                                    </label>
                                                </cell>
                                            </row>
                                            <row id="547">
                                                <property name="style">tabledetailslabel</property>
                                                <list-property name="visibility">
                                                    <structure>
                                                        <property name="format">all</property>
                                                        <expression name="valueExpr">row["isasset"] == 1</expression>
                                                    </structure>
                                                </list-property>
                                                <cell id="548">
                                                    <property name="style">tabledetailslabelcell</property>
                                                    <label id="575">
                                                        <text-property name="text" key="openwo_wo">WO</text-property>
                                                    </label>
                                                </cell>
                                                <cell id="549">
                                                    <property name="style">tabledetailslabelcell</property>
                                                    <label id="852">
                                                        <text-property name="text" key="openwo_desc">Description</text-property>
                                                    </label>
                                                </cell>
                                                <cell id="550">
                                                    <property name="style">tabledetailslabelcell</property>
                                                    <label id="853">
                                                        <text-property name="text" key="openwo_status">Status</text-property>
                                                    </label>
                                                </cell>
                                                <cell id="551">
                                                    <property name="style">tabledetailslabelcell</property>
                                                    <label id="854">
                                                        <text-property name="text" key="openwo_asset">Asset</text-property>
                                                    </label>
                                                </cell>
                                                <cell id="552">
                                                    <property name="style">tabledetailslabelcell</property>
                                                    <label id="855">
                                                        <text-property name="text" key="openwo_assetdesc">Asset Description</text-property>
                                                    </label>
                                                </cell>
                                                <cell id="839">
                                                    <property name="style">tabledetailslabelcell</property>
                                                    <label id="856">
                                                        <text-property name="text" key="openwo_remdur">Rem Dur</text-property>
                                                    </label>
                                                </cell>
                                                <cell id="844">
                                                    <property name="style">tabledetailslabelcell</property>
                                                    <label id="857">
                                                        <text-property name="text" key="openwo_schedst">Sched Start</text-property>
                                                    </label>
                                                </cell>
                                                <cell id="849">
                                                    <property name="style">tabledetailslabelcell</property>
                                                    <label id="859">
                                                        <text-property name="text" key="openwo_schedfin">Sched Finish</text-property>
                                                    </label>
                                                </cell>
                                                <cell id="553">
                                                    <property name="style">tabledetailslabelcell</property>
                                                    <label id="858">
                                                        <text-property name="text" key="openwo_actst">Actual Start</text-property>
                                                    </label>
                                                </cell>
                                            </row>
                                            <row id="984">
                                                <property name="style">tabledetailslabel</property>
                                                <list-property name="visibility">
                                                    <structure>
                                                        <property name="format">all</property>
                                                        <expression name="valueExpr">row["isasset"] == 0</expression>
                                                    </structure>
                                                </list-property>
                                                <cell id="985">
                                                    <property name="style">tabledetailslabelcell</property>
                                                    <label id="994">
                                                        <text-property name="text" key="openwo_wo">WO</text-property>
                                                    </label>
                                                </cell>
                                                <cell id="986">
                                                    <property name="style">tabledetailslabelcell</property>
                                                    <label id="995">
                                                        <text-property name="text" key="openwo_desc">Description</text-property>
                                                    </label>
                                                </cell>
                                                <cell id="987">
                                                    <property name="style">tabledetailslabelcell</property>
                                                    <label id="996">
                                                        <text-property name="text" key="openwo_status">Status</text-property>
                                                    </label>
                                                </cell>
                                                <cell id="988">
                                                    <property name="style">tabledetailslabelcell</property>
                                                    <label id="997">
                                                        <text-property name="text" key="openwo_loc">Location</text-property>
                                                    </label>
                                                </cell>
                                                <cell id="989">
                                                    <property name="style">tabledetailslabelcell</property>
                                                    <label id="998">
                                                        <text-property name="text" key="openwo_locdesc">Location Description</text-property>
                                                    </label>
                                                </cell>
                                                <cell id="990">
                                                    <property name="style">tabledetailslabelcell</property>
                                                    <label id="999">
                                                        <text-property name="text" key="openwo_remdur">Rem Dur</text-property>
                                                    </label>
                                                </cell>
                                                <cell id="991">
                                                    <property name="style">tabledetailslabelcell</property>
                                                    <label id="1000">
                                                        <text-property name="text" key="openwo_schedst">Sched Start</text-property>
                                                    </label>
                                                </cell>
                                                <cell id="992">
                                                    <property name="style">tabledetailslabelcell</property>
                                                    <label id="1002">
                                                        <text-property name="text" key="openwo_schedfin">Sched Finish</text-property>
                                                    </label>
                                                </cell>
                                                <cell id="993">
                                                    <property name="style">tabledetailslabelcell</property>
                                                    <label id="1001">
                                                        <text-property name="text" key="openwo_actst">Actual Start</text-property>
                                                    </label>
                                                </cell>
                                            </row>
                                        </header>
                                        <detail>
                                            <row id="554">
                                                <property name="style">tabledetailsdatarow</property>
                                                <cell id="555">
                                                    <property name="style">tabledetailsdatacell</property>
                                                    <data id="870">
                                                        <property name="resultSetColumn">wonum</property>
                                                        <list-property name="action">
                                                            <structure>
                                                                <property name="formatType">html</property>
                                                                <property name="linkType">drill-through</property>
                                                                <property name="reportName">woprint.rptdesign</property>
                                                                <property name="targetWindow">_self</property>
                                                                <property name="targetFileType">report-design</property>
                                                                <list-property name="paramBindings">
                                                                    <structure>
                                                                        <property name="paramName">where</property>
                                                                        <simple-property-list name="expression">
                                                                            <value>" workorder.workorderid='" + row["workorderid"] + "' "</value>
                                                                        </simple-property-list>
                                                                    </structure>
                                                                    <structure>
                                                                        <property name="paramName">appname</property>
                                                                        <simple-property-list name="expression">
                                                                            <value>"WOTRACK"</value>
                                                                        </simple-property-list>
                                                                    </structure>
                                                                    <structure>
                                                                        <property name="paramName">paramdelimiter</property>
                                                                        <simple-property-list name="expression">
                                                                            <value>params["paramdelimiter"]</value>
                                                                        </simple-property-list>
                                                                    </structure>
                                                                    <structure>
                                                                        <property name="paramName">paramstring</property>
                                                                        <simple-property-list name="expression">
                                                                            <value>params["paramstring"]</value>
                                                                        </simple-property-list>
                                                                    </structure>
                                                                </list-property>
                                                            </structure>
                                                        </list-property>
                                                    </data>
                                                </cell>
                                                <cell id="556">
                                                    <property name="style">tabledetailsdatacell</property>
                                                    <data id="874">
                                                        <property name="resultSetColumn">description</property>
                                                    </data>
                                                </cell>
                                                <cell id="557">
                                                    <property name="style">tabledetailsdatacell</property>
                                                    <data id="875">
                                                        <property name="resultSetColumn">status</property>
                                                    </data>
                                                </cell>
                                                <cell id="558">
                                                    <property name="style">tabledetailsdatacell</property>
                                                    <data id="876">
                                                        <property name="resultSetColumn">key</property>
                                                    </data>
                                                </cell>
                                                <cell id="559">
                                                    <property name="style">tabledetailsdatacell</property>
                                                    <data id="877">
                                                        <property name="resultSetColumn">keydesc</property>
                                                    </data>
                                                </cell>
                                                <cell id="840">
                                                    <property name="style">tabledetailsdatacell</property>
                                                    <data id="878">
                                                        <property name="resultSetColumn">remdur</property>
                                                    </data>
                                                </cell>
                                                <cell id="845">
                                                    <property name="style">tabledetailsdatacell</property>
                                                    <data id="879">
                                                        <structure name="dateTimeFormat">
                                                            <property name="category">Custom</property>
                                                            <property name="pattern">M/dd/yyyy h:mm</property>
                                                        </structure>
                                                        <property name="resultSetColumn">schedstart</property>
                                                    </data>
                                                </cell>
                                                <cell id="850">
                                                    <property name="style">tabledetailsdatacell</property>
                                                    <data id="880">
                                                        <structure name="dateTimeFormat">
                                                            <property name="category">Custom</property>
                                                            <property name="pattern">M/dd/yyyy h:mm</property>
                                                        </structure>
                                                        <property name="resultSetColumn">schedfinish</property>
                                                    </data>
                                                </cell>
                                                <cell id="560">
                                                    <property name="style">tabledetailsdatacell</property>
                                                    <data id="881">
                                                        <structure name="dateTimeFormat">
                                                            <property name="category">Custom</property>
                                                            <property name="pattern">M/dd/yyyy h:mm</property>
                                                        </structure>
                                                        <property name="resultSetColumn">actstart</property>
                                                    </data>
                                                </cell>
                                            </row>
                                        </detail>
                                    </table>
                                </cell>
                            </row>
                            <row id="1617">
                                <property name="pageBreakInside">auto</property>
                                <cell id="1618">
                                    <property name="colSpan">6</property>
                                    <property name="rowSpan">1</property>
                                    <table id="777">
                                        <property name="marginTop">2pt</property>
                                        <property name="width">100%</property>
                                        <property name="dataSet">pmDataSet</property>
                                        <list-property name="visibility">
                                            <structure>
                                                <property name="format">all</property>
                                                <expression name="valueExpr">row["pmnumcount"]==0</expression>
                                            </structure>
                                        </list-property>
                                        <list-property name="paramBindings">
                                            <structure>
                                                <property name="paramName">isasset</property>
                                                <simple-property-list name="expression">
                                                    <value>row["isasset"]</value>
                                                </simple-property-list>
                                            </structure>
                                            <structure>
                                                <property name="paramName">siteid</property>
                                                <simple-property-list name="expression">
                                                    <value>row["siteid"]</value>
                                                </simple-property-list>
                                            </structure>
                                            <structure>
                                                <property name="paramName">location</property>
                                                <simple-property-list name="expression">
                                                    <value>row["location"]</value>
                                                </simple-property-list>
                                            </structure>
                                            <structure>
                                                <property name="paramName">assetnum</property>
                                                <simple-property-list name="expression">
                                                    <value>row["assetnum"]</value>
                                                </simple-property-list>
                                            </structure>
                                        </list-property>
                                        <list-property name="boundDataColumns">
                                            <structure>
                                                <property name="name">pmnum</property>
                                                <expression name="expression">dataSetRow["pmnum"]</expression>
                                                <property name="dataType">string</property>
                                            </structure>
                                            <structure>
                                                <property name="name">description</property>
                                                <expression name="expression">dataSetRow["description"]</expression>
                                                <property name="dataType">string</property>
                                            </structure>
                                            <structure>
                                                <property name="name">nextdate</property>
                                                <expression name="expression">dataSetRow["nextdate"]</expression>
                                                <property name="dataType">string</property>
                                            </structure>
                                            <structure>
                                                <property name="name">pmnumcount</property>
                                                <property name="dataType">integer</property>
                                                <property name="aggregateFunction">COUNT</property>
                                                <list-property name="arguments">
                                                    <structure>
                                                        <property name="name">Expression</property>
                                                        <expression name="value">row["pmnum"]</expression>
                                                    </structure>
                                                </list-property>
                                            </structure>
                                        </list-property>
                                        <property name="pageBreakInterval">50</property>
                                        <column id="806">
                                            <property name="width">1in</property>
                                        </column>
                                        <column id="807">
                                            <property name="width">3in</property>
                                        </column>
                                        <column id="808">
                                            <property name="width">1in</property>
                                        </column>
                                        <column id="1007">
                                            <property name="width">5in</property>
                                        </column>
                                        <header>
                                            <row id="780">
                                                <property name="style">tableheaderrow</property>
                                                <cell id="781">
                                                    <property name="colSpan">4</property>
                                                    <property name="rowSpan">1</property>
                                                    <property name="style">tableheaderlabel</property>
                                                    <label id="782">
                                                        <text-property name="text" key="openwo_nextdue">Next Due PM</text-property>
                                                    </label>
                                                </cell>
                                            </row>
                                            <row id="788">
                                                <property name="style">tabledetailslabel</property>
                                                <cell id="789">
                                                    <property name="style">tabledetailslabelcell</property>
                                                    <label id="790">
                                                        <text-property name="text" key="openwo_pm">PM</text-property>
                                                    </label>
                                                </cell>
                                                <cell id="791">
                                                    <property name="style">tabledetailslabelcell</property>
                                                    <label id="860">
                                                        <text-property name="text" key="openwo_pmdesc">PM Description</text-property>
                                                    </label>
                                                </cell>
                                                <cell id="792">
                                                    <property name="style">tabledetailslabelcell</property>
                                                    <label id="861">
                                                        <text-property name="text" key="openwo_duedate">Due Date</text-property>
                                                    </label>
                                                </cell>
                                                <cell id="1005">
                                                    <property name="style">tabledetailslabelcell</property>
                                                </cell>
                                            </row>
                                        </header>
                                        <detail>
                                            <row id="796">
                                                <property name="style">tabledetailsdatarow</property>
                                                <cell id="797">
                                                    <property name="style">tabledetailsdatacell</property>
                                                    <data id="872">
                                                        <property name="resultSetColumn">pmnum</property>
                                                    </data>
                                                </cell>
                                                <cell id="799">
                                                    <property name="style">tabledetailsdatacell</property>
                                                    <data id="883">
                                                        <property name="resultSetColumn">description</property>
                                                    </data>
                                                </cell>
                                                <cell id="800">
                                                    <property name="style">tabledetailsdatacell</property>
                                                    <data id="930">
                                                        <structure name="dateTimeFormat">
                                                            <property name="category">Short Date</property>
                                                            <property name="pattern">Short Date</property>
                                                        </structure>
                                                        <property name="resultSetColumn">nextdate</property>
                                                    </data>
                                                </cell>
                                                <cell id="1006">
                                                    <property name="style">tabledetailsdatacell</property>
                                                </cell>
                                            </row>
                                        </detail>
                                    </table>
                                </cell>
                            </row>
                            <row id="1624">
                                <property name="pageBreakInside">auto</property>
                                <cell id="1625">
                                    <property name="colSpan">6</property>
                                    <property name="rowSpan">1</property>
                                    <table id="885">
                                        <property name="marginTop">2pt</property>
                                        <property name="width">100%</property>
                                        <property name="dataSet">pmMeterDataSet</property>
                                        <list-property name="visibility">
                                            <structure>
                                                <property name="format">all</property>
                                                <expression name="valueExpr">row["pmnumcount"]==0</expression>
                                            </structure>
                                        </list-property>
                                        <list-property name="paramBindings">
                                            <structure>
                                                <property name="paramName">isasset</property>
                                                <simple-property-list name="expression">
                                                    <value>row["isasset"]</value>
                                                </simple-property-list>
                                            </structure>
                                            <structure>
                                                <property name="paramName">siteid</property>
                                                <simple-property-list name="expression">
                                                    <value>row["siteid"]</value>
                                                </simple-property-list>
                                            </structure>
                                            <structure>
                                                <property name="paramName">location</property>
                                                <simple-property-list name="expression">
                                                    <value>row["location"]</value>
                                                </simple-property-list>
                                            </structure>
                                            <structure>
                                                <property name="paramName">assetnum</property>
                                                <simple-property-list name="expression">
                                                    <value>row["assetnum"]</value>
                                                </simple-property-list>
                                            </structure>
                                        </list-property>
                                        <list-property name="boundDataColumns">
                                            <structure>
                                                <property name="name">pmnum</property>
                                                <expression name="expression">dataSetRow["pmnum"]</expression>
                                                <property name="dataType">string</property>
                                            </structure>
                                            <structure>
                                                <property name="name">metername</property>
                                                <expression name="expression">dataSetRow["metername"]</expression>
                                                <property name="dataType">string</property>
                                            </structure>
                                            <structure>
                                                <property name="name">lastreading</property>
                                                <expression name="expression">dataSetRow["lastreading"]</expression>
                                                <property name="dataType">decimal</property>
                                            </structure>
                                            <structure>
                                                <property name="name">readingatnextwo</property>
                                                <expression name="expression">dataSetRow["readingatnextwo"]</expression>
                                                <property name="dataType">decimal</property>
                                            </structure>
                                            <structure>
                                                <property name="name">average</property>
                                                <expression name="expression">dataSetRow["average"]</expression>
                                                <property name="dataType">string</property>
                                            </structure>
                                            <structure>
                                                <property name="name">predicteddate</property>
                                                <expression name="expression">dataSetRow["predicteddate"]</expression>
                                                <property name="dataType">date-time</property>
                                            </structure>
                                            <structure>
                                                <property name="name">pmnumcount</property>
                                                <property name="dataType">integer</property>
                                                <property name="aggregateFunction">COUNT</property>
                                                <list-property name="arguments">
                                                    <structure>
                                                        <property name="name">Expression</property>
                                                        <expression name="value">row["pmnum"]</expression>
                                                    </structure>
                                                </list-property>
                                            </structure>
                                        </list-property>
                                        <property name="pageBreakInterval">50</property>
                                        <column id="917">
                                            <property name="width">1in</property>
                                        </column>
                                        <column id="918">
                                            <property name="width">2in</property>
                                        </column>
                                        <column id="919">
                                            <property name="width">2in</property>
                                        </column>
                                        <column id="920">
                                            <property name="width">2in</property>
                                        </column>
                                        <column id="921">
                                            <property name="width">1in</property>
                                        </column>
                                        <column id="922">
                                            <property name="width">2in</property>
                                        </column>
                                        <header>
                                            <row id="888">
                                                <property name="style">tableheaderrow</property>
                                                <cell id="889">
                                                    <property name="colSpan">6</property>
                                                    <property name="rowSpan">1</property>
                                                    <property name="style">tableheaderlabel</property>
                                                    <label id="890">
                                                        <text-property name="text" key="openwo_nextdue">Next Due PM</text-property>
                                                    </label>
                                                </cell>
                                            </row>
                                            <row id="895">
                                                <property name="style">tabledetailslabel</property>
                                                <cell id="896">
                                                    <property name="style">tabledetailslabelcell</property>
                                                    <label id="897">
                                                        <text-property name="text" key="openwo_pm">PM</text-property>
                                                    </label>
                                                </cell>
                                                <cell id="898">
                                                    <property name="style">tabledetailslabelcell</property>
                                                    <label id="899">
                                                        <text-property name="text" key="openwo_meternm">Meter Name</text-property>
                                                    </label>
                                                </cell>
                                                <cell id="900">
                                                    <property name="style">tabledetailslabelcell</property>
                                                    <label id="901">
                                                        <text-property name="text" key="openwo_lastrd">Last Reading from WO</text-property>
                                                    </label>
                                                </cell>
                                                <cell id="902">
                                                    <property name="style">tabledetailslabelcell</property>
                                                    <label id="903">
                                                        <text-property name="text" key="openwo_meterrd">Meter Reading</text-property>
                                                    </label>
                                                </cell>
                                                <cell id="904">
                                                    <property name="style">tabledetailslabelcell</property>
                                                    <label id="905">
                                                        <text-property name="text" key="openwo_avguse">Average Usage</text-property>
                                                    </label>
                                                </cell>
                                                <cell id="906">
                                                    <property name="style">tabledetailslabelcell</property>
                                                    <label id="907">
                                                        <text-property name="text" key="openwo_nextpreddt">Next Predicted Date</text-property>
                                                    </label>
                                                </cell>
                                            </row>
                                        </header>
                                        <detail>
                                            <row id="908">
                                                <property name="style">tabledetailsdatarow</property>
                                                <cell id="909">
                                                    <property name="style">tabledetailsdatacell</property>
                                                    <data id="924">
                                                        <property name="resultSetColumn">pmnum</property>
                                                    </data>
                                                </cell>
                                                <cell id="911">
                                                    <property name="style">tabledetailsdatacell</property>
                                                    <data id="925">
                                                        <property name="resultSetColumn">metername</property>
                                                    </data>
                                                </cell>
                                                <cell id="913">
                                                    <property name="style">tabledetailsdatacell</property>
                                                    <data id="1244">
                                                        <property name="resultSetColumn">lastreading</property>
                                                    </data>
                                                </cell>
                                                <cell id="914">
                                                    <property name="style">tabledetailsdatacell</property>
                                                    <data id="927">
                                                        <property name="resultSetColumn">readingatnextwo</property>
                                                    </data>
                                                </cell>
                                                <cell id="915">
                                                    <property name="style">tabledetailsdatacell</property>
                                                    <data id="928">
                                                        <property name="resultSetColumn">average</property>
                                                    </data>
                                                </cell>
                                                <cell id="916">
                                                    <property name="style">tabledetailsdatacell</property>
                                                    <data id="929">
                                                        <structure name="dateTimeFormat">
                                                            <property name="category">Short Date</property>
                                                            <property name="pattern">Short Date</property>
                                                        </structure>
                                                        <property name="resultSetColumn">predicteddate</property>
                                                    </data>
                                                </cell>
                                            </row>
                                        </detail>
                                    </table>
                                </cell>
                            </row>
                        </detail>
                    </table>
                </cell>
            </row>
        </grid>
    </body>
</report>
